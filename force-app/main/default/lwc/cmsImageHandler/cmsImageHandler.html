<template>
    <div class="image-container">
        <!-- Debug info -->
        <template if:true={isLoading}>
            <div class="debug-info slds-text-body_small slds-p-around_small slds-theme_info">
                <p><strong>Loading:</strong> Record ID: {recordId}, Field: {fieldName}</p>
                <p><strong>Content Key:</strong> {contentKey}</p>
            </div>
        </template>

        <!-- Loading state -->
        <template if:true={isLoading}>
            <div class="slds-spinner_container">
                <lightning-spinner alternative-text="Loading image" size="small"></lightning-spinner>
                <p class="slds-assistive-text">Loading image...</p>
            </div>
        </template>

        <!-- Error state -->
        <template if:true={isError}>
            <div class="error-message slds-theme_error slds-p-around_small">
                <p><strong>Error:</strong> {errorMessage}</p>
                <p><strong>Record ID:</strong> {recordId}</p>
                <p><strong>Field:</strong> {fieldName}</p>
                <p><strong>URL Attempted:</strong> "{displayImageUrl}"</p>
                <p><strong>Content Key:</strong> "{contentKey}"</p>
            </div>
        </template>

        <!-- Image display -->
        <template if:false={isError}>
            <img 
                src={displayImageUrl} 
                alt={alternativeText}
                class={imageClasses}
                onerror={handleError}
                onload={handleLoad}
                loading="lazy"
            />
        </template>
    </div>
</template>
